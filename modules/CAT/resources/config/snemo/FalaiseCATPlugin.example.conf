# - Configuration
#@description Tracker clusterization using the CAT module
#@key_label   "name"
#@meta_label  "type"

####################################################################
# - Module load section
# only the custom module CAT needs loading
# the rest are known system modules, either known to
# the dpp namespace or
# the snemo::processing namespace
[name="flreconstruct.plugins" type=""]
plugins : string[1] = "Falaise_CAT"
# Adapt this path to the location of Falaise_CAT
Falaise_CAT.directory : string = "BuildProducts/lib/x86_64-linux-gnu/Falaise/modules"


####################################################################
# Must define "pipeline" as this is the module flreconstruct will use
# Define the main chain of modules in the pipeline:
# 1. Mock Digitize and Mock Calibrate
# 2. Clusterize tracker hits using the CAT algorithm
# 3. Clusterize tracker hits using the SULTAN algorithm
[name="pipeline" type="dpp::chain_module"]
modules : string[3] = "MockCalibration" "CAT" "SULTAN"


####################################################################
# Here is the first in the pipeline, itself a chain module
[name="MockCalibration" type="dpp::chain_module"]

#@config A chain of processing modules that performs the mock calibration

#@description The list of processing modules chained along the pipeline
modules : string[2] = "CalibrateTracker" "CalibrateCalorimeters"


####################################################################
[name="CalibrateTracker" type="snemo::processing::mock_tracker_s2c_module"]

#@config A mock tracker calibration module

#@description The name of the geometry service
Geo_label : string = "geometry"


####################################################################
[name="CalibrateCalorimeters" type="snemo::processing::mock_calorimeter_s2c_module"]

#@config A mock calorimeter claibration module

#@description The name of the geometry service
Geo_label : string = "geometry"

#@description The names of the calorimeter-like hit categories to be processed
hit_categories  : string[3]  = "calo" "xcalo" "gveto"


####################################################################
# Here is the second in the pipeline: the CAT module
[name="CAT" type="snemo::reconstruction::cat_tracker_clustering_module"]

# #@description The name of the 'calibrated data' bank used as input
# CD_label  : string  = "CD"

#@description The name of the 'tracker clustering data' bank used as output
# TCD_label  : string  = "TCD"

# #@description Force the CAT algorithm to consider a 25 gauss magnetic field (temporary trick)
# CAT.magnetic_field        : real    = 25 gauss

# #@description To be described
# CAT.level                 : string  = "normal"

# #@description To be described
# CAT.max_time              : real    = 5000.0 ms

# #@description To be described
# CAT.small_radius          : real    = 1.0 mm

# #@description To be described
# CAT.probmin               : real    = 0.0

# #@description To be described
# CAT.nofflayers            : integer = 1

# #@description To be described
# CAT.first_event           : integer = -1

# #@description To be described
# #@description Force the CAT algorithm to consider a 25 gauss magnetic field (temporary trick)
# CAT.ratio                 : real    = 10000.0

# #@description To be described
# CAT.driver.sigma_z_factor : real = 1.0

####################################################################
# Here is the third in the pipeline: the SULTAN module
[name="SULTAN" type="snemo::reconstruction::sultan_tracker_clustering_module"]

# #@description The name of the 'calibrated data' bank used as input
# CD_label  : string  = "CD"

#@description The name of the 'tracker clustering data' bank used as output
TCD_label  : string  = "TCD2"

# #@description Force the SULTAN algorithm to consider a 25 gauss magnetic field (temporary trick)
# SULTAN.magnetic_field     : real    = 25 gauss

# #@description To be described
# SULTAN.clusterizer_level  : string  = "normal"

# #@description To be described
# SULTAN.sequentiator_level : string  = "normal"

# #@description To be described
# SULTAN.max_time     : real  = 10000 ms

# #@description To be described
# SULTAN.Emin         : real  = 200 keV

# #@description To be described
# SULTAN.Emax         : real  = 7.0 MeV

# #@description To be described
# SULTAN.probmin      : real  = 0

# #@description To be described
# SULTAN.nsigma_r     : real  = 5.0

# #@description To be described
# SULTAN.nsigma_z     : real  = 3.0

# #@description To be described
# SULTAN.nofflayers   : integer  = 0

# #@description To be described
# SULTAN.first_event  : integer  = -1

# #@description To be described
# SULTAN.min_ncells_in_cluster        : integer  = 0

# #@description To be described
# SULTAN.ncells_between_triplet_min   : integer  = 0

# #@description To be described
# SULTAN.ncells_between_triplet_range : integer  = 0

# #@description To be described
# SULTAN.nsigmas                      : real  = 1.0

# #@description To be described
# SULTAN.SULTAN.driver.sigma_z_factor : real  = 1.0
