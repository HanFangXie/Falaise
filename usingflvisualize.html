<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Falaise: Using The FLVisualize Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Falaise
   &#160;<span id="projectnumber">4.0.0</span>
   </div>
   <div id="projectbrief">SuperNEMO Software Toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using The FLVisualize Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="usingflvisualize_intro"></a>
Introduction to FLVisualize </h1>
<p>FLVisualize is the main detector/event viewer GUI for Falaise, and can display both raw and reconstructed data for the BiPo3 and Demonstrator detectors. It can be used to view:</p>
<ul>
<li>Raw detector geometries,</li>
<li>Raw/Calibrated data from flsimulate,</li>
<li>Reconstructed tracks and calorimetry.</li>
</ul>
<p>Here we present a brief overview of running FLVisualize from the command line.</p>
<h1><a class="anchor" id="usingflvisualize_examples"></a>
Example Usage </h1>
<p>The flvisualize program is a command line application just like any other Unix style program (e.g. <code>ls</code>). In the following, we will write commands assuming that <code>flvisualize</code> is in your path. If it is not, simply use the relative or absolute path to <code>flvisualize</code>.</p>
<p>You can get help on the options that can be passed to <code>flvisualize</code> by running it with the <code>-h</code> or <code>--help</code> options, e.g.</p>
<div class="fragment"><div class="line">$ flvisualize --help</div><div class="line">flvisualize (3.0.0) : the SuperNEMO event display application</div><div class="line"></div><div class="line">Usage:</div><div class="line">  flvisualize [options]</div><div class="line"></div><div class="line">General options:</div><div class="line">  -h [ --help ]                         produce help message</div><div class="line">  --version                             print version number</div><div class="line">  -P [ --logging-priority ] level (=notice)</div><div class="line">                                        set the logging priority threshold</div><div class="line">  -l [ --load-dll ] library             set a DLL to be loaded.</div><div class="line">  -x [ --experiment-setup ] tag         set the experimental setup tag.</div><div class="line">  -v [ --variant-config ] tag           set the variant configuration.</div><div class="line">  -f [ --variant-profile ] tag          set the variant profile.</div><div class="line">  -s [ --services-config ] tag          set the services configuration.</div><div class="line">  -G [ --ignore-input-metadata ] flag (=0)</div><div class="line">                                        flag to ignore input metadata</div><div class="line">  -M [ --input-metadata-file ] file     file from which to load metadata</div><div class="line">  -i [ --input-file ] file              file from which to read input data</div><div class="line">                                        (simulation, real)</div><div class="line"></div><div class="line">Browser options:</div><div class="line">  -S [ --scale ] value                  scale factor for computer screen</div><div class="line">                                        (height/width)</div><div class="line">  -a [ --auto-reading-delay ] value     automatic event reading delay in</div><div class="line">                                        seconds</div><div class="line">  --detector-config-file file           set the path to the detector</div><div class="line">                                        configuration file</div><div class="line">  --style-config-file file              set the path to the style configuration</div><div class="line">                                        file</div><div class="line">  --cut-config-file file                set the path to the cut configuration</div><div class="line">                                        file</div><div class="line">  --preload                             enable the load in memory of Boost</div><div class="line">                                        archive files (working only with pure</div><div class="line">                                        &#39;bxg4_production&#39; output)</div><div class="line">  -I [ --input-data-files ] file        set an input data file(s)</div><div class="line"></div><div class="line">View options:</div><div class="line">  --2d-display position (=left)         set 2D display position</div><div class="line">  --full-2d-view                        add a new tab with top/front/side 2D</div><div class="line">                                        view in one frame</div><div class="line">  --focus-on-roi                        focus views on the &#39;region-of-interest&#39;</div><div class="line">  --show-simulated-vertex flag          show simulated vertex</div><div class="line">  --show-simulated-tracks flag          show simulated tracks</div><div class="line">  --show-simulated-hits flag            show simulated hits</div><div class="line">  --show-calibrated-hits flag           show calibrated hits</div><div class="line">  --show-calibrated-info flag           show calibrated info</div><div class="line">  --show-tracker-clustered-hits flag    show tracker clustered hits</div><div class="line">  --show-tracker-trajectories flag      show tracker trajectories</div><div class="line">  --show-particle-tracks flag           show particle tracks</div><div class="line"></div><div class="line">Kernel options:</div><div class="line">  --datatools::logging level (=fatal)   Set the Bayeux/datatools kernel&#39;s</div><div class="line">                                        logging priority threshold.</div><div class="line">                                        Example :</div><div class="line">                                          --datatools::logging=&quot;trace&quot;</div><div class="line">  --datatools::resource-path rule       Register a resource path mounted</div><div class="line">                                        through an identifier (library or</div><div class="line">                                        module name).</div><div class="line">                                        Example : Register the &quot;path1/subdir1&quot;</div><div class="line">                                        path as the root directory of the &quot;foo&quot;</div><div class="line">                                        library and the &quot;path2/subdir2&quot; path as</div><div class="line">                                        the root directory of the &quot;bar&quot;</div><div class="line">                                        software module:</div><div class="line">                                          --datatools::resource-path=&quot;foo@path1</div><div class="line">                                        /subdir1&quot;</div><div class="line">                                          --datatools::resource-path=&quot;bar@path2</div><div class="line">                                        /subdir2&quot;</div><div class="line"></div><div class="line">Examples:</div><div class="line"></div><div class="line"> 1) Using default configuration :</div><div class="line">    flvisualize \</div><div class="line">      --input-file &lt;simulation/reconstruction file&gt;</div><div class="line"> 2) Auto reading mode:</div><div class="line">    flvisualize \</div><div class="line">      --verbose \</div><div class="line">      --auto-reading-delay 2 \</div><div class="line">      --input-file &lt;simulation/reconstruction file&gt;</div><div class="line"> 3) Using special experimental setup with variant profile:</div><div class="line">    flvisualize \</div><div class="line">      --verbose \</div><div class="line">      --experiment-setup &quot;urn:snemo:demonstrator:setup:1.0&quot; \</div><div class="line">      --variant-profile &quot;variant.profile&quot; \</div><div class="line">      --input-file &lt;simulation/reconstruction file&gt;</div></div><!-- fragment --><p>If no command line arguments are passed, then <code>flvisualize</code> will start up and display the SuperNEMO demonstrator default geometry model (tag=`"urn:snemo:demonstrator:setup:1.0"̀ with its default variant profile):</p>
<div class="fragment"><div class="line">$ flvisualize</div><div class="line">... GUI window should pop up ...</div></div><!-- fragment --><p>To visualize a data file output by the <code>flsimulate</code> or <code>flreconstruct</code> applications, you need to supply the input file:</p>
<div class="fragment"><div class="line">$ flvisualize -i example.brio</div></div><!-- fragment --><p>If metadata are embedded in the input data file, they are extracted from it and FLSimulate tries to guess the experimental setup and the associated geometry model it should use in combinaison with the data. If an explicit <em>variant profile</em> has been used to configure the geometry, it must be given in the command line because once started, FLSimulate (in its current version) cannot switch to another geometry model on the fly. In such case, the recommended way to invoke <code>flvisualize</code> is to explicitely describe the geometry setup from the command line:</p>
<div class="fragment"><div class="line">$ flvisualize \</div><div class="line">  -x &quot;urn:snemo:demonstrator:setup:1.0&quot; \</div><div class="line">  -f &quot;my-variant.profile&quot; \</div><div class="line">  -i example.brio</div></div><!-- fragment --><p>If metadata are only provided from an external file, you should use: </p><div class="fragment"><div class="line">$ flvisualize \</div><div class="line">  -M example.meta \</div><div class="line">  -i example.brio</div></div><!-- fragment --><p>If external metadata <em>and</em> a non registered variant profile should be used (no registered official tag is supported for it), you should use: </p><div class="fragment"><div class="line">$ flvisualize \</div><div class="line">  -M example.meta \</div><div class="line">  -f &quot;my-unregistered-variant.profile&quot; \</div><div class="line">  -i example.brio</div></div><!-- fragment --><p>The program displays its main window with a two panels event viewer. The image below shows a Tl-208 decays from a field wire in the tracking volume with emission of one electron and three gamma rays. On the left panel, the <em>Focus on ROI</em> option is activated (see below).</p>
<div class="image">
<img src="flv_event_0.png" alt="flv_event_0.png"/>
<div class="caption">
FLVisualize main window with one displayed event</div></div>
 <p>Files may also be opened using the <code>"File-&gt;Open file..."</code> GUI menu item. In this case, the experimental setup (geometry) and variant profile should have been set at start from the command line as shown above.</p>
<h1>Description of the display </h1>
<p>The top bar contains four menus:</p>
<ul>
<li><code>File</code> : allow to load an input data file from FLSimulate or FLReconstruct, reload a previously loaded file (rewind), save individual events in XML file, load style file, quit the application.</li>
<li><code>View</code> : activate special display drivers (x3d, ROOT'S GL viewer), save images of the events,</li>
<li><code>Options</code> : focus on the event's <em>region of interest</em> (<em>ROI</em>, automatically computed), activate the rendering of some parts of the event models:<ul>
<li>truth hits (from the <code>SD</code> bank,</li>
<li>calibrated hits (from the <code>CD</code> bank),</li>
<li>fitted tracks and reconstruction patterns (from reconstruction banks)...</li>
</ul>
</li>
<li><code>Misc.</code> : additional options.</li>
</ul>
<p>By default, FLVisualize starts with two panels, one (left) for the detector top view and the other (right) for a 3D rotating view.</p>
<p>The left panel allows to switch between top, side and front views thanks to radiobuttons at the bottom.</p>
<p>The right panel contains several pans:</p>
<ul>
<li><code>Overview</code> : display the 3D view</li>
<li><code>Tracks</code> : display a hierachy of the event data models with vertex, hits, tracks and other reconstruction data structures stored in the event model. Check boxes allow to make the corresponding graphics representations visible or not on the display.</li>
<li><code>Options</code> : proposes a set of additional display options (colors...)</li>
<li><code>Selection</code> : allows to select events given a set of cuts.</li>
</ul>
<p>A bottom bar contains:</p>
<ul>
<li>a message log combo,</li>
<li>an event number entry widget,</li>
<li>a set of navigation buttons to loop on input events (forward/backward).</li>
</ul>
<p>It is recommended to maximize the size of the FLVisualize's main window on your desktop.</p>
<p>Regarding event selection, the selection is done on data bank level. For instance, it is possible to select event by setting a range of run/event ids, a cut that operates on the event header bank. It is also possible to use homemade cuts by defining a cut manager file that holds several cut files. The cut manager file should look likes</p>
<div class="fragment"><div class="line">#@description Logging priority</div><div class="line">logging.priority : string = &quot;error&quot;</div><div class="line"></div><div class="line">#@description A list of files that contains definition of cuts</div><div class="line">cuts.configuration_files : string[1] as path = &quot;event_header_cuts.conf&quot;</div></div><!-- fragment --><p>where <code>event_header_cuts.conf</code> file can hold an event list id cut such as</p>
<div class="fragment"><div class="line">#@description A sample list of setups</div><div class="line">#@key_label   &quot;name&quot;</div><div class="line">#@meta_label  &quot;type&quot;</div><div class="line"></div><div class="line">[name=&quot;list_of_ids_cut&quot; type=&quot;snemo::cut::event_header_cut&quot;]</div><div class="line"></div><div class="line">#@description Cut description</div><div class="line">cut.description : string = &quot;Select event following a list of event ids&quot;</div><div class="line"></div><div class="line">#@description Logging priority</div><div class="line">logging.priority : string = &quot;error&quot;</div><div class="line"></div><div class="line">#@description The label/name of the event header&#39; bank (mandatory)</div><div class="line">EH_label : string = &quot;EH&quot;</div><div class="line"></div><div class="line">#@description Activate list of event ids mode</div><div class="line">mode.list_of_event_ids : boolean = true</div><div class="line"></div><div class="line">#@description Filename with event id</div><div class="line">list_of_event_ids.ids : string[5] = &quot;0_3&quot;  &quot;0_7&quot;  &quot;0_15&quot; &quot;0_25&quot; &quot;0_69&quot;</div></div><!-- fragment --><p>Only events from run <code>0</code> and with event ids <code>3, 7, 15, 25</code> and <code>69</code> will be selected.</p>
<p>To make use of this cut, <code>flvisualize</code> program should be run with the <code>--cut-config-file</code> option set :</p>
<div class="fragment"><div class="line">$ flvisualize \</div><div class="line">  --cut-config-file cut_manager.conf \</div><div class="line">  -i example.brio</div></div><!-- fragment --><p>The additionnal <code>--cut-config-file</code> will enable the "Complex cut" widget and the <code>list_of_ids_cut</code> may be selected within the combo box.</p>
<h1>Known Issues </h1>
<p>Performance may be affected on slower systems or those without modern graphics cards due to the complexity of the geometry.</p>
<p>macOS systems may also see some performance loss on startup and moving between events.</p>
<p>Both issues are under investigation. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
